# ERD 사이트 기능 정의서

## 1. 핵심 기능 목록

### 1.1 ERD 다이어그램 편집
- ✅ **엔티티 생성/편집**
- ✅ **관계선 생성/편집**
- ✅ **컬럼 관리** (추가/삭제/편집)
- ✅ **인덱스 관리** (생성/편집/삭제)
- ✅ **외래키 관리** (ON UPDATE/DELETE 설정)
- ✅ **드래그 앤 드롭** 인터페이스
- ✅ **실행 취소/다시 실행**

### 1.2 파일 관리
- ✅ **새 프로젝트 생성**
- ✅ **프로젝트 저장** (.erd 파일)
- ✅ **프로젝트 불러오기**
- ✅ **자동 저장** (5분 간격)
- ✅ **복구 기능** (예기치 않은 종료 시)

### 1.3 내보내기 기능
- ✅ **PNG 이미지** 내보내기
- ✅ **SVG 이미지** 내보내기
- ✅ **MySQL DDL** 생성
- ✅ **JSON 데이터** 내보내기

### 1.4 캔버스 조작
- ✅ **확대/축소** (마우스 휠)
- ✅ **이동** (스페이스바 + 드래그)
- ✅ **그리드 표시/숨김**
- ✅ **무한 스크롤**

## 2. 상세 기능 정의

### 2.1 엔티티 관리

#### 엔티티 생성
- **방법 1**: 왼쪽 도구 패널에서 엔티티 아이콘을 캔버스로 드래그
- **방법 2**: 캔버스 더블클릭으로 기본 엔티티 생성
- **방법 3**: 단축키 `E`로 엔티티 생성

**엔티티 생성 시 설정:**
- **물리적 이름**: 한국어 이름 (예: "회원", "게시판", "댓글")
- **논리적 이름**: 영문 이름 (예: "user", "board", "reply")
- **기본 컬럼**: 자동으로 기본 컬럼들 생성 (id, created_at 등)

#### 엔티티 편집
- **더블클릭**: 하단 패널 열림 (mysqlworkbench2.png 참조)
- **이름 변경**: 엔티티 제목 더블클릭 또는 속성 패널에서 편집
- **물리적/논리적 이름 편집**: 하단 패널에서 개별 편집 가능
- **크기 조절**: 엔티티 모서리 드래그
- **이동**: 엔티티 드래그

### 2.2 컬럼 관리

#### 컬럼 추가
1. 엔티티 더블클릭 → 하단 패널 열림
2. "컬럼" 탭 선택
3. "+ 컬럼 추가" 버튼 클릭
4. 컬럼 정보 입력 (mysqlworkbench2.png 참조):
   - 컬럼명 (Column Name)
   - 데이터 타입 (Datatype: VARCHAR, INT, DATE 등)
   - 길이 (필요시)
   - PK (Primary Key) 체크박스
   - NN (Not Null) 체크박스
   - UQ (Unique) 체크박스
   - UN (Unsigned) 체크박스
   - AI (Auto Increment) 체크박스
   - 기본값 (Default/Expression)
   - 주석 (Comments)
   - **제외 속성**: B (Binary), ZF (Zero Fill), G (Generated) - 사용자 요구사항에 따라 제외

#### 컬럼 편집
- 컬럼명 더블클릭으로 인라인 편집
- 속성 패널에서 상세 편집
- 드래그로 순서 변경

### 2.3 인덱스 관리

#### 인덱스 생성
1. 엔티티 더블클릭 → 하단 패널 열림
2. "인덱스" 탭 선택
3. "+ 인덱스 추가" 버튼 클릭
4. 인덱스 설정:
   - 인덱스명
   - 인덱스 타입 (PRIMARY, UNIQUE, INDEX)
   - 포함할 컬럼 선택
   - 정렬 순서 (ASC/DESC)

### 2.4 외래키 관리

#### 외래키 생성
1. 엔티티 더블클릭 → 하단 패널 열림
2. "외래키" 탭 선택
3. "+ 외래키 추가" 버튼 클릭
4. 외래키 설정:
   - 외래키명
   - 소스 컬럼 선택
   - 타겟 엔티티 선택
   - 타겟 컬럼 선택
   - ON UPDATE 옵션 (CASCADE, SET NULL, NO ACTION, RESTRICT)
   - ON DELETE 옵션 (CASCADE, SET NULL, NO ACTION, RESTRICT)

### 2.5 관계선 관리

#### 관계선 생성
1. 엔티티의 연결 포트 클릭
2. 드래그하여 다른 엔티티의 연결 포트에 연결
3. 관계선 속성 설정:
   - 카디널리티 (1:1, 1:N, N:M)
   - 관계 유형 (식별/비식별)
   - 관계명

## 3. 파일 형식

### 3.1 .erd 파일 구조
```json
{
  "projectName": "프로젝트명",
  "version": "1.0.0",
  "createdAt": "2024-01-01T00:00:00Z",
  "lastModifiedAt": "2024-01-01T12:00:00Z",
  "diagrams": [
    {
      "id": "erd-main",
      "name": "메인 ERD",
      "nodes": [...],
      "edges": [...]
    }
  ]
}
```

### 3.2 MySQL DDL 생성
```sql
CREATE TABLE `users` (
  `user_id` INT NOT NULL AUTO_INCREMENT,
  `username` VARCHAR(50) NOT NULL,
  `email` VARCHAR(100) NOT NULL,
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`user_id`),
  UNIQUE KEY `idx_username` (`username`)
);
```

## 4. 제한사항

### 4.1 초기 지원 범위
- **데이터베이스**: MySQL만 지원
- **Import 기능**: 미지원 (Export만 지원)
- **복잡한 제약조건**: 기본적인 PK, FK, UK만 지원

### 4.2 브라우저 지원
- **필수**: Chrome 89+, Firefox 88+, Safari 14+
- **선택**: File System Access API 지원 브라우저

## 5. 성능 요구사항

### 5.1 응답성
- 엔티티 생성: 100ms 이내
- 저장: 500ms 이내
- DDL 생성: 1초 이내

### 5.2 확장성
- 최대 100개 엔티티 지원
- 최대 1000개 컬럼 지원
- 최대 500개 관계선 지원

## 6. 예외 케이스 정의

### 6.1 데이터 무결성 관련 예외
- **FK 참조 오류**: FK로 관계를 맺는데 PK가 없는 컬럼에서 선택한 경우
  - **해결**: PK가 있는 컬럼만 FK로 선택 가능하도록 제한
  - **사용자 피드백**: "PK가 없는 컬럼은 FK로 사용할 수 없습니다."
- **존재하지 않는 참조**: 존재하지 않는 엔티티나 컬럼을 참조하는 경우
  - **해결**: 참조 대상이 삭제되면 FK도 자동 삭제 또는 경고
  - **사용자 피드백**: "참조 대상이 존재하지 않습니다."
- **순환 참조**: 자기 자신을 참조하는 경우
  - **해결**: 자기 참조는 허용하지 않음
  - **사용자 피드백**: "자기 자신을 참조할 수 없습니다."

### 6.2 입력 유효성 관련 예외
- **중복 컬럼명**: 같은 엔티티 내에서 중복된 컬럼명 입력 시
  - **해결**: 물리적 이름과 논리적 이름 모두 고려하여 중복 검사
  - **사용자 피드백**: "이미 존재하는 컬럼명입니다."
- **잘못된 데이터 타입**: 지원하지 않는 데이터 타입 입력 시
  - **해결**: MySQL 지원 데이터 타입만 허용
  - **사용자 피드백**: "지원하지 않는 데이터 타입입니다."
- **필수 필드 누락**: PK, FK 등 필수 설정 누락 시
  - **해결**: 필수 필드 입력 강제 또는 경고
  - **사용자 피드백**: "필수 필드를 입력해주세요."

### 6.3 관계 설정 관련 예외
- **카디널리티 오류**: 잘못된 카디널리티 설정 (예: 1:1에서 다중 선택)
  - **해결**: 관계 유형에 맞는 카디널리티만 허용
  - **사용자 피드백**: "이 관계 유형에 맞지 않는 카디널리티입니다."
- **유효하지 않은 포트**: 관계선 연결 시 유효하지 않은 포트 선택
  - **해결**: 연결 가능한 포트만 하이라이트
  - **사용자 피드백**: "연결할 수 없는 포트입니다."

### 6.4 성능 관련 예외
- **과도한 인덱스**: 너무 많은 인덱스 생성 시
  - **해결**: 인덱스 개수 제한 또는 경고
  - **사용자 피드백**: "인덱스가 너무 많아 성능에 영향을 줄 수 있습니다."
- **복잡한 관계**: 너무 복잡한 관계로 인한 성능 저하 가능성
  - **해결**: 관계 복잡도 계산 및 경고
  - **사용자 피드백**: "복잡한 관계로 인해 성능이 저하될 수 있습니다."

### 6.5 파일 관련 예외
- **저장 실패**: 파일 저장 중 오류 발생 시
  - **해결**: 자동 백업 및 복구 시도
  - **사용자 피드백**: "저장에 실패했습니다. 자동 백업을 확인해주세요."
- **불러오기 실패**: 파일 불러오기 중 오류 발생 시
  - **해결**: 파일 형식 검증 및 오류 메시지
  - **사용자 피드백**: "파일을 불러올 수 없습니다. 파일 형식을 확인해주세요." 
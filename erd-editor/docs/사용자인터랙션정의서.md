# ERD 사이트 사용자 인터랙션 정의서

## 1. 주요 사용자 시나리오

### 1.1 새로운 ERD 프로젝트 생성
**사용자**: 데이터베이스 설계자
**목표**: 새로운 데이터베이스 구조를 설계하기 위한 ERD 프로젝트 생성

**시나리오 플로우**:
1. 브라우저에서 ERD 사이트 접속
2. "새 프로젝트" 버튼 클릭 또는 `Ctrl+N`
3. 프로젝트명 입력 (예: "사용자 관리 시스템")
4. "생성" 버튼 클릭
5. 빈 캔버스와 함께 에디터 화면 표시

### 1.2 엔티티 생성 및 편집
**사용자**: 개발자
**목표**: 데이터베이스 테이블을 ERD에서 생성하고 상세 정보 설정

**시나리오 플로우**:
1. 왼쪽 도구 패널에서 📦 엔티티 아이콘 클릭
2. 캔버스 원하는 위치에 드래그 앤 드롭
3. 엔티티 이름 더블클릭하여 "User" 입력
4. 엔티티 더블클릭 → 하단 패널 열림
5. "컬럼" 탭에서 컬럼 추가:
   - `user_id` (INT, PK)
   - `username` (VARCHAR(50), NOT NULL)
   - `email` (VARCHAR(100), NOT NULL)
   - `created_at` (DATETIME, DEFAULT CURRENT_TIMESTAMP)

### 1.3 관계선 생성
**사용자**: 데이터 모델러
**목표**: 두 엔티티 간의 관계를 정의

**시나리오 플로우**:
1. User 엔티티 우측 연결 포트 클릭
2. 드래그하여 Post 엔티티 좌측 연결 포트에 연결
3. 관계선 선택 → 우측 속성 패널에서 설정:
   - 카디널리티: 1:N
   - 관계 유형: 비식별 관계
   - 관계명: "작성"

### 1.4 인덱스 생성
**사용자**: DBA
**목표**: 성능 최적화를 위한 인덱스 설정

**시나리오 플로우**:
1. User 엔티티 더블클릭 → 하단 패널 열림
2. "인덱스" 탭 선택
3. "+ 인덱스 추가" 버튼 클릭
4. 인덱스 설정:
   - 인덱스명: `idx_username`
   - 타입: UNIQUE
   - 컬럼: `username`
   - 정렬: ASC

### 1.5 외래키 설정
**사용자**: 개발자
**목표**: 참조 무결성을 위한 외래키 제약조건 설정

**시나리오 플로우**:
1. Post 엔티티 더블클릭 → 하단 패널 열림
2. "외래키" 탭 선택
3. "+ 외래키 추가" 버튼 클릭
4. 외래키 설정:
   - 외래키명: `fk_post_user`
   - 소스 컬럼: `user_id`
   - 타겟 엔티티: `User`
   - 타겟 컬럼: `user_id`
   - ON UPDATE: CASCADE
   - ON DELETE: RESTRICT

### 1.6 MySQL DDL 생성
**사용자**: 개발자
**목표**: 설계된 ERD를 실제 데이터베이스 스키마로 변환

**시나리오 플로우**:
1. 상단 메뉴에서 "파일" → "내보내기" → "MySQL DDL"
2. 생성된 SQL 스크립트 미리보기
3. "복사" 버튼 클릭하여 클립보드에 복사
4. MySQL 클라이언트에서 실행

## 2. 상세 인터랙션 플로우

### 2.1 엔티티 더블클릭 인터랙션
```
사용자 액션: 엔티티 더블클릭
↓
시스템 반응: 하단 패널 열림 (mysqlworkbench2.png 참조)
↓
패널 탭 표시: [컬럼] [인덱스] [외래키]
↓
기본 탭: "컬럼" 탭 활성화
↓
컬럼 목록 표시 (기존 컬럼이 있는 경우)
↓
사용자 액션: "+ 컬럼 추가" 버튼 클릭
↓
새 컬럼 행 추가 (편집 모드)
↓
사용자 입력: 컬럼 정보 입력
↓
저장: Enter 키 또는 다른 곳 클릭
```

### 2.2 드래그 앤 드롭 인터랙션
```
사용자 액션: 도구 패널에서 엔티티 아이콘 클릭
↓
시각적 피드백: 아이콘 반전 또는 그림자 효과
↓
사용자 액션: 캔버스로 드래그
↓
시각적 피드백: 
- 마우스 커서 변경 (드래그 커서)
- 미리보기 엔티티 표시
- 스냅 가이드 표시 (그리드에 맞춤)
↓
사용자 액션: 원하는 위치에서 마우스 버튼 해제
↓
시스템 반응: 
- 새 엔티티 노드 생성
- 기본 이름 설정 ("New Entity")
- 선택 상태로 변경
↓
사용자 액션: 이름 더블클릭하여 편집
```

### 2.3 관계선 연결 인터랙션
```
사용자 액션: 엔티티 연결 포트 클릭
↓
시각적 피드백: 포트 하이라이트
↓
사용자 액션: 드래그
↓
시각적 피드백:
- 관계선 미리보기 표시
- 연결 가능한 포트 하이라이트
- 연결 불가능한 포트 비활성화
↓
사용자 액션: 타겟 엔티티 연결 포트에 드롭
↓
시스템 반응:
- 관계선 생성
- 기본 관계 속성 설정
- 관계선 선택 상태로 변경
↓
사용자 액션: 우측 속성 패널에서 관계 설정
```

### 2.4 설정 메뉴 인터랙션
```
사용자 액션: 우측 상단 설정 버튼 클릭
↓
시스템 반응: 설정 메뉴 팝업 표시 (erdcloud2.png 참조)
↓
메뉴 항목 표시:
- 🎨 테마 설정
- 📐 그리드 설정
- ⌨️ 단축키
- 🌐 언어
- ℹ️ 정보
↓
사용자 액션: 원하는 메뉴 항목 클릭
↓
시스템 반응: 해당 설정 화면 표시
↓
사용자 액션: 설정 변경
↓
시스템 반응: 즉시 적용 및 저장
```

## 3. 키보드 단축키

### 3.1 기본 단축키
| 단축키 | 기능 | 설명 |
|--------|------|------|
| `Ctrl+N` | 새 프로젝트 | 새로운 ERD 프로젝트 생성 |
| `Ctrl+S` | 저장 | 현재 프로젝트 저장 |
| `Ctrl+O` | 열기 | 기존 프로젝트 불러오기 |
| `Ctrl+Z` | 실행 취소 | 이전 작업 취소 |
| `Ctrl+Y` | 다시 실행 | 취소된 작업 복원 |
| `Delete` | 삭제 | 선택된 요소 삭제 |
| `Ctrl+C` | 복사 | 선택된 요소 복사 |
| `Ctrl+V` | 붙여넣기 | 복사된 요소 붙여넣기 |
| `Ctrl+A` | 모두 선택 | 모든 요소 선택 |

### 3.2 편집 단축키
| 단축키 | 기능 | 설명 |
|--------|------|------|
| `E` | 엔티티 추가 | 새 엔티티 생성 |
| `R` | 관계선 추가 | 새 관계선 생성 |
| `C` | 주석 추가 | 새 주석 생성 |
| `T` | 텍스트 추가 | 새 텍스트 요소 생성 |
| `F2` | 이름 편집 | 선택된 요소 이름 편집 |
| `Enter` | 편집 완료 | 편집 모드 종료 |

### 3.3 캔버스 조작 단축키
| 단축키 | 기능 | 설명 |
|--------|------|------|
| `Space + 드래그` | 캔버스 이동 | 캔버스 위치 변경 |
| `마우스 휠` | 확대/축소 | 캔버스 확대/축소 |
| `Ctrl + 마우스 휠` | 확대/축소 | 더 빠른 확대/축소 |
| `Home` | 전체 보기 | 모든 요소가 보이도록 조정 |
| `Ctrl + 0` | 100% 확대 | 기본 크기로 복원 |

## 4. 오류 처리 및 피드백

### 4.1 유효성 검사
- **중복 컬럼명**: 같은 엔티티 내 중복 컬럼명 입력 시 경고
- **잘못된 데이터 타입**: 지원하지 않는 데이터 타입 입력 시 오류
- **순환 참조**: 자기 자신을 참조하는 외래키 생성 시 경고
- **필수 필드 누락**: PK, FK 등 필수 설정 누락 시 경고

### 4.2 사용자 피드백
- **성공 메시지**: 작업 완료 시 녹색 토스트 메시지
- **경고 메시지**: 문제가 있을 수 있는 작업 시 노란색 경고
- **오류 메시지**: 오류 발생 시 빨간색 오류 메시지
- **진행 표시**: 시간이 걸리는 작업 시 로딩 스피너

### 4.3 복구 기능
- **자동 저장**: 5분마다 자동 저장
- **복구 대화상자**: 예기치 않은 종료 시 복구 여부 확인
- **임시 파일**: 작업 중인 내용을 임시 파일로 보관

## 5. 예외 상황 인터랙션

### 5.1 FK 참조 오류 시나리오
**사용자**: 개발자
**상황**: FK로 관계를 맺으려고 하는데 PK가 없는 컬럼에서 선택

**인터랙션 플로우:**
1. 사용자가 FK 관계선을 생성하려고 함
2. PK가 없는 컬럼을 FK 소스로 선택
3. 시스템이 즉시 경고 메시지 표시: "PK가 없는 컬럼은 FK로 사용할 수 없습니다."
4. PK가 있는 컬럼만 하이라이트하여 선택 가능하게 함
5. 사용자가 올바른 컬럼 선택 후 관계 생성

### 5.2 중복 컬럼명 입력 시나리오
**사용자**: 데이터 모델러
**상황**: 같은 엔티티 내에서 중복된 컬럼명 입력

**인터랙션 플로우:**
1. 사용자가 새 컬럼 추가 시도
2. 물리적 이름 "이메일" 입력 (이미 존재)
3. 시스템이 실시간으로 중복 검사
4. 경고 메시지 표시: "이미 존재하는 컬럼명입니다."
5. 입력 필드에 빨간색 테두리 표시
6. 사용자가 다른 이름으로 수정

### 5.3 순환 참조 시나리오
**사용자**: 개발자
**상황**: 자기 자신을 참조하는 FK 생성 시도

**인터랙션 플로우:**
1. 사용자가 FK 관계선을 생성하려고 함
2. 같은 엔티티의 다른 컬럼을 참조하려고 시도
3. 시스템이 즉시 경고: "자기 자신을 참조할 수 없습니다."
4. 관계선 생성이 차단됨
5. 사용자에게 다른 엔티티를 참조하도록 안내

### 5.4 파일 저장 실패 시나리오
**사용자**: 모든 사용자
**상황**: 파일 저장 중 네트워크 오류 또는 권한 문제

**인터랙션 플로우:**
1. 사용자가 Ctrl+S로 저장 시도
2. 저장 실패 발생
3. 오류 메시지 표시: "저장에 실패했습니다. 자동 백업을 확인해주세요."
4. 자동 백업 파일 경로 표시
5. "다시 시도" 버튼과 "다른 이름으로 저장" 버튼 제공
6. 사용자가 선택하여 문제 해결 